<!DOCTYPE html>
<html class="light" lang="pt-BR">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Gerenciar Obra</title>
    <link rel="stylesheet" href="./css/main.css">
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&amp;display=swap" rel="stylesheet"/>
    <!-- FUNCIONAL COM FIREBASE -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        "primary": "#4B341C",
                        "background": "#f8f7f6",
                        "surface": "#ffffff",
                        "text": "#181411",
                        "text-secondary": "#897561",
                        "border": "#e6e0db"
                    },
                    fontFamily: {
                        "display": ["Inter", "sans-serif"]
                    },
                    borderRadius: {
                        "DEFAULT": "0.5rem",
                        "lg": "0.75rem",
                        "xl": "1rem",
                        "full": "9999px"
                    },
                },
            },
        }
    </script>
    <style>
        body {
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>
    <!-- se inspirar nesse design -->
    <style>
        body {
            min-height: max(884px, 100dvh);
        }
    </style>
</head>
<body class="bg-background-light dark:bg-background-dark font-display text-text-light-primary dark:text-text-dark-primary">
    <div class="main">
        <div class="relative flex min-h-screen w-full flex-col">
            <!-- Top App Bar -->
            <header class="sticky top-0 z-10 flex h-16 items-center border-b border-border-light dark:border-border-dark bg-surface-light/80 dark:bg-surface-dark/80 backdrop-blur-sm p-4">
                <h1 class="flex-1 text-center text-lg font-bold">Gerenciar Obra</h1>
                <button id="submitSalvar" class="px-4 py-2 text-primary text-base font-bold leading-normal tracking-wide">Salvar</button>
            </header>
            
            <!-- Main Content -->
            <main class="flex-1 space-y-6 p-4 pb-28">
                <!-- Section 1: Informações Gerais -->
                <section>
                    <h2 class="text-text-light-primary dark:text-text-dark-primary text-xl font-bold leading-tight tracking-tight mb-4">Informações Gerais</h2>
                    <div class="space-y-4">
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Nome da Obra</p>
                            <input id="nomedaobra" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="Ex: Reforma Apartamento 101" value=""/>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Localização</p>
                            <input id="local" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="Endereço completo da obra" value=""/>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Descrição</p>
                            <textarea id="descricao" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary min-h-36 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="Detalhes importantes sobre o projeto..."></textarea>
                        </label>
                    </div>
                </section>

                <!-- Section 2: Responsáveis Técnicos -->
                <section>
                    <h2 class="text-text-light-primary dark:text-text-dark-primary text-xl font-bold leading-tight tracking-tight mb-4">Responsáveis Técnicos</h2>
                    <div class="space-y-4">
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Engenheiro Responsável</p>
                            <input id="engenheiro" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="Nome do engenheiro responsável" value=""/>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Arquiteto Responsável</p>
                            <input id="arquiteto" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="Nome do arquiteto responsável" value=""/>
                        </label>
                    </div>
                </section>

                <!-- Section 3: Prazos e Logística -->
                <section>
                    <h2 class="text-text-light-primary dark:text-text-dark-primary text-xl font-bold leading-tight tracking-tight mb-4">Prazos e Logística</h2>
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <label class="flex flex-col">
                                <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Data Inicial</p>
                                <div class="relative">
                                    <input id="datainicial" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal pr-10" type="date" value=""/>
                                    <span class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-light-secondary dark:text-text-dark-secondary">calendar_today</span>
                                </div>
                            </label>
                            <label class="flex flex-col">
                                <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Data Final</p>
                                <div class="relative">
                                    <input id="datafinal" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal pr-10" type="date" value=""/>
                                    <span class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-light-secondary dark:text-text-dark-secondary">calendar_today</span>
                                </div>
                            </label>
                        </div>
                        
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Data de Entrega do Material</p>
                            <div class="relative">
                                <input id="dataEntregaMaterial" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal pr-10" type="date" value=""/>
                                <span class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-light-secondary dark:text-text-dark-secondary">inventory_2</span>
                            </div>
                        </label>

                        <div class="space-y-4">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Horário de Trabalho</p>
                            
                            <div class="grid grid-cols-2 gap-4">
                                <label class="flex flex-col">
                                    <p class="text-text-light-primary dark:text-text-dark-primary text-sm font-medium leading-normal pb-1">Início</p>
                                    <div class="relative">
                                        <input id="horarioInicio" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-12 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal pr-10" type="time" value="08:00"/>
                                        <span class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-light-secondary dark:text-text-dark-secondary">schedule</span>
                                    </div>
                                </label>
                                
                                <label class="flex flex-col">
                                    <p class="text-text-light-primary dark:text-text-dark-primary text-sm font-medium leading-normal pb-1">Término</p>
                                    <div class="relative">
                                        <input id="horarioTermino" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-12 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal pr-10" type="time" value="18:00"/>
                                        <span class="material-symbols-outlined pointer-events-none absolute right-3 top-1/2 -translate-y-1/2 text-text-light-secondary dark:text-text-dark-secondary">schedule</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section 4: Equipe -->
                <section>
                    <h2 class="text-text-light-primary dark:text-text-dark-primary text-xl font-bold leading-tight tracking-tight mb-4">Equipe</h2>
                    <div>
                        <!-- codigo abaixo vai clicar no botao submite e adicionar os operadores a uma lista javascript -->
                        <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Operadores Envolvidos</p>
                        <div class="relative flex items-center">
                            <input list="operatorsDL" id="operadortolist" class="apenas-texto form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 pr-14 text-base font-normal leading-normal" placeholder="Nome do operador">
                            <datalist id="operatorsDL"></datalist>
                            <button id="submitOperator" class="absolute right-2 flex size-10 items-center justify-center rounded-lg bg-primary text-white">
                                <span class="material-symbols-outlined">add</span>
                            </button>
                        </div>

                        <div class="flex flex-wrap gap-2 pt-3" id="operatorsCards">
                            <!-- base de um card do operador -->
                        </div>
                    </div>
                </section>

                <!-- Section 5: Informações do Cliente -->
                <section>
                    <h2 class="text-text-light-primary dark:text-text-dark-primary text-xl font-bold leading-tight tracking-tight mb-4">Informações do Cliente</h2>
                    <div class="space-y-4">
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Nome do Cliente</p>
                            <input list="clientesDL" id="nomeCliente" name="nomeCliente" placeholder="Nome completo" class="apenas-texto flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal"/>
                            <datalist id="clientesDL"></datalist>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">CPF/CNPJ</p>
                            <input id="cpfcnpjcliente" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="CPF/CNPJ" value="" type="text" maxlength="16" onkeypress="return blockSpecialChar(event)"/>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">Email do Cliente</p>
                            <input id="emailcliente" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="exemplo@email.com" type="email" value=""/>
                        </label>
                        <label class="flex flex-col">
                            <p class="text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal pb-2">WhatsApp</p>
                            <input id="whatsappcliente" class="form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden rounded-lg bg-surface-light dark:bg-surface-dark text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark focus:border-primary focus:ring-primary h-14 placeholder:text-text-light-secondary dark:placeholder:text-text-dark-secondary p-4 text-base font-normal leading-normal" placeholder="00000000000" type="tel" value="" maxlength="18" onkeypress="return blockSpecialChar(event)"/>
                        </label>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <script src="./javascript/main.js"></script>
    <script type="text/javascript">
        // Para múltiplos inputs
        const input1 = document.getElementById("nomeCliente");
        input1.addEventListener("input", function(event) {
            const input = event.target;
            // Substitui caracteres não alfanuméricos por uma string vazia
            input.value = input.value.replace(/[^a-zA-ZÀ-ÿ\s]/g, '');
        });

        const input2 = document.getElementById("operadortolist");
        input2.addEventListener("input", function(event) {
            const input = event.target;
            // Substitui caracteres não alfanuméricos por uma string vazia
            input.value = input.value.replace(/[^a-zA-ZÀ-ÿ\s]/g, '');
        });

        // Adicionar validação para os novos campos
        const input3 = document.getElementById("engenheiro");
        input3.addEventListener("input", function(event) {
            const input = event.target;
            input.value = input.value.replace(/[^a-zA-ZÀ-ÿ\s]/g, '');
        });

        const input4 = document.getElementById("arquiteto");
        input4.addEventListener("input", function(event) {
            const input = event.target;
            input.value = input.value.replace(/[^a-zA-ZÀ-ÿ\s]/g, '');
        });

        function blockSpecialChar(e){
            var k;
            document.all ? k = e.keyCode : k = e.which;
            return ((k > 64 && k < 91) || (k > 96 && k < 123) || k == 8 || k == 32 || (k >= 48 && k <= 57));
        }
        
        // Seleciona o elemento input
        const inputElemento = document.getElementById('cpfcnpjcliente');
        // Adiciona um listener para o evento 'input'
        inputElemento.addEventListener('input', function(event) {
            const input = event.target;
            // Substitui caracteres não alfanuméricos por uma string vazia
            input.value = input.value.replace(/[^a-zA-Z0-9]/g, '');
        });
        
        // Seleciona o elemento input
        const inputElement2 = document.getElementById('whatsappcliente');
        // Adiciona um listener para o evento 'input'
        inputElement2.addEventListener('input', function(event) {
            const input = event.target;
            // Substitui caracteres não alfanuméricos por uma string vazia
            input.value = input.value.replace(/[^a-zA-Z0-9]/g, '');
        });
        
        // Seleciona o elemento de input pelo ID
        const campo1 = document.getElementById('cpfcnpjcliente');
        // Adiciona um "ouvinte" para o evento de 'input' (toda vez que o valor muda)
        campo1.addEventListener('input', function (e) {
            // A expressão regular /[^0-9]/g encontra qualquer caractere que NÃO seja de 0 a 9
            // e o substitui por uma string vazia ("")
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });
        
        // Seleciona o elemento de input pelo ID
        const campo2 = document.getElementById('whatsappcliente');
        // Adiciona um "ouvinte" para o evento de 'input' (toda vez que o valor muda)
        campo2.addEventListener('input', function (e) {
            // A expressão regular /[^0-9]/g encontra qualquer caractere que NÃO seja de 0 a 9
            // e o substitui por uma string vazia ("")
            e.target.value = e.target.value.replace(/[^0-9]/g, '');
        });

        // Configurar datas padrão
        document.addEventListener('DOMContentLoaded', function() {
            // Data atual
            const hoje = new Date();
            const dataHoje = hoje.toISOString().split('T')[0];
            
            // Data 7 dias a partir de hoje (entrega de material)
            const seteDias = new Date(hoje);
            seteDias.setDate(hoje.getDate() + 7);
            const dataSeteDias = seteDias.toISOString().split('T')[0];
            
            // Data 30 dias a partir de hoje (final do projeto)
            const trintaDias = new Date(hoje);
            trintaDias.setDate(hoje.getDate() + 30);
            const dataTrintaDias = trintaDias.toISOString().split('T')[0];
            
            // Configurar valores padrão
            if (document.getElementById('datainicial')) {
                document.getElementById('datainicial').value = dataHoje;
                document.getElementById('datainicial').min = dataHoje;
            }
            
            if (document.getElementById('datafinal')) {
                document.getElementById('datafinal').value = dataTrintaDias;
                document.getElementById('datafinal').min = dataHoje;
            }
            
            if (document.getElementById('dataEntregaMaterial')) {
                document.getElementById('dataEntregaMaterial').value = dataSeteDias;
                document.getElementById('dataEntregaMaterial').min = dataHoje;
            }
        });
    </script>
    
    <script src="./javascript/gerente.mjs" type="module"></script>
    <script type="module" src="./javascript/firebase.mjs"></script>
    <script src="./javascript/backEndHandle.mjs" type="module"></script>
</body>
</html>